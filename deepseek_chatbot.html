<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeepSeek Financial Chatbot</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d1117;
        }
        .chat-container {
            height: 80vh;
            display: flex;
            flex-direction: column;
            background-color: #161b22;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .message-area {
            flex-grow: 1;
            overflow-y: auto;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        .message {
            max-width: 80%;
            padding: 0.75rem 1rem;
            border-radius: 1rem;
        }
        .user-message {
            background-color: #1f6feb;
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 0.25rem;
        }
        .bot-message {
            background-color: #30363d;
            color: #c9d1d9;
            align-self: flex-start;
            border-bottom-left-radius: 0.25rem;
        }
        .input-area {
            display: flex;
            padding: 1rem;
            border-top: 1px solid #30363d;
            background-color: #161b22;
        }
        .loader {
            width: 1.5rem;
            height: 1.5rem;
            border: 4px solid #1f6feb;
            border-bottom-color: transparent;
            border-radius: 50%;
            display: inline-block;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
        }
        @keyframes rotation {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body class="p-6">
    <div class="max-w-4xl mx-auto chat-container">
        <!-- Chat Header -->
        <div class="p-4 bg-gray-800 text-white rounded-t-lg flex items-center justify-between">
            <div class="flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8 mr-3 text-cyan-400">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18.75a60.051 60.051 0 0 1 1.77-5.071c.421-.861.908-1.745 1.454-2.656m1.114 1.114a2.25 2.25 0 1 0-.756-3.896.75.75 0 0 1 .425-1.125c.87-.215 1.83-.215 2.7-.001.385.096.757.254 1.113.468M9.548 11.082a4.5 4.5 0 0 0-3.321 4.316m3.321-4.316c.395-.653.945-1.229 1.638-1.724a1.851 1.851 0 0 1 1.25-.494h.005a1.851 1.851 0 0 1 1.25.494c.693.495 1.243 1.071 1.638 1.724m3.321-4.316a4.5 4.5 0 0 1 3.321 4.316m-3.321-4.316a3.75 3.75 0 0 1-5.642-4.045m5.642 4.045c.421.861.908 1.745 1.454 2.656m-.756-3.896a2.25 2.25 0 1 0-.756-3.896" />
                </svg>
                <h1 class="text-xl font-bold">DeepSeek Financial Chatbot</h1>
            </div>
        </div>

        <!-- Chat Messages Area -->
        <div id="message-area" class="message-area">
            <div class="message bot-message">
                Hello! I am a Seasoned Financial Analyst. How can I assist with your financial queries today?
            </div>
        </div>

        <!-- Input Area -->
        <div class="input-area">
            <input id="user-input" type="text" placeholder="Ask a question about finance..."
                   class="flex-grow p-3 rounded-l-md bg-gray-700 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all">
            <button id="send-button"
                    class="bg-blue-600 text-white p-3 rounded-r-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-200">
                Send
            </button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Your DeepSeek API Key goes here.
            // **Important**: For production use, you should handle this server-side to keep it secure.
            const DEEPSEEK_API_KEY = "sk-78d5e6954adf4171ad33b3ad708729b1";
            const DEEPSEEK_API_URL = "https://api.deepseek.com/chat/completions";
            const MODEL_NAME = "deepseek-chat";

            const userInput = document.getElementById('user-input');
            const sendButton = document.getElementById('send-button');
            const messageArea = document.getElementById('message-area');

            let conversationHistory = [
                {
                    "role": "system",
                    "content": "You are a seasoned financial analyst. Your purpose is to provide clear, concise, and professional financial insights based on your expertise. Always maintain a professional tone and provide information relevant to business finance."
                }
            ];

            const showLoadingIndicator = () => {
                const loadingDiv = document.createElement('div');
                loadingDiv.id = 'loading-indicator';
                loadingDiv.className = 'message bot-message flex items-center gap-2';
                loadingDiv.innerHTML = '<span class="loader"></span> Loading...';
                messageArea.appendChild(loadingDiv);
                messageArea.scrollTop = messageArea.scrollHeight;
            };

            const hideLoadingIndicator = () => {
                const loadingDiv = document.getElementById('loading-indicator');
                if (loadingDiv) {
                    loadingDiv.remove();
                }
            };

            const displayMessage = (message, sender) => {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${sender}-message`;
                messageDiv.textContent = message;
                messageArea.appendChild(messageDiv);
                messageArea.scrollTop = messageArea.scrollHeight;
            };

            const sendMessage = async () => {
                const userMessage = userInput.value.trim();
                if (userMessage === '') return;

                displayMessage(userMessage, 'user');
                conversationHistory.push({ "role": "user", "content": userMessage });
                userInput.value = '';
                showLoadingIndicator();

                try {
                    const response = await fetch(DEEPSEEK_API_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${DEEPSEEK_API_KEY}`
                        },
                        body: JSON.stringify({
                            model: MODEL_NAME,
                            messages: conversationHistory,
                            stream: false
                        })
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(`API Error: ${response.status} - ${errorData.error.message}`);
                    }

                    const data = await response.json();
                    const botResponse = data.choices[0].message.content;

                    hideLoadingIndicator();
                    displayMessage(botResponse, 'bot');
                    conversationHistory.push({ "role": "assistant", "content": botResponse });

                } catch (error) {
                    console.error('Error fetching data from DeepSeek API:', error);
                    hideLoadingIndicator();
                    displayMessage('Sorry, something went wrong. Please check your API key or try again later.', 'bot');
                }
            };

            sendButton.addEventListener('click', sendMessage);
            userInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
        });
    </script>
</body>
</html>
